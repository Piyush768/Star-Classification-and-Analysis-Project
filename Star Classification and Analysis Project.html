<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ebd0ade63c254216bb1d486612a4bc48</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" id="vkdZuQSGcm23">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</div>
<section id="step-2" class="cell markdown" id="Gz2hJ0iNp0IC">
<h1>Step 2</h1>
</section>
<section id="21" class="cell markdown" id="CKD0fxG4p4or">
<h3>2.1</h3>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:383}"
id="QH9NeKrScqj4" data-outputId="5b49bede-20af-462a-cf96-8c02d3828a24">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">&#39;star_classification.csv&#39;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obj_ID</th>
      <th>alpha</th>
      <th>delta</th>
      <th>u</th>
      <th>g</th>
      <th>r</th>
      <th>i</th>
      <th>z</th>
      <th>run_ID</th>
      <th>rerun_ID</th>
      <th>cam_col</th>
      <th>field_ID</th>
      <th>spec_obj_ID</th>
      <th>class</th>
      <th>redshift</th>
      <th>plate</th>
      <th>MJD</th>
      <th>fiber_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.237661e+18</td>
      <td>135.689107</td>
      <td>32.494632</td>
      <td>23.87882</td>
      <td>22.27530</td>
      <td>20.39501</td>
      <td>19.16573</td>
      <td>18.79371</td>
      <td>3606</td>
      <td>301</td>
      <td>2</td>
      <td>79</td>
      <td>6.543777e+18</td>
      <td>GALAXY</td>
      <td>0.634794</td>
      <td>5812</td>
      <td>56354</td>
      <td>171</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.237665e+18</td>
      <td>144.826101</td>
      <td>31.274185</td>
      <td>24.77759</td>
      <td>22.83188</td>
      <td>22.58444</td>
      <td>21.16812</td>
      <td>21.61427</td>
      <td>4518</td>
      <td>301</td>
      <td>5</td>
      <td>119</td>
      <td>1.176014e+19</td>
      <td>GALAXY</td>
      <td>0.779136</td>
      <td>10445</td>
      <td>58158</td>
      <td>427</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.237661e+18</td>
      <td>142.188790</td>
      <td>35.582444</td>
      <td>25.26307</td>
      <td>22.66389</td>
      <td>20.60976</td>
      <td>19.34857</td>
      <td>18.94827</td>
      <td>3606</td>
      <td>301</td>
      <td>2</td>
      <td>120</td>
      <td>5.152200e+18</td>
      <td>GALAXY</td>
      <td>0.644195</td>
      <td>4576</td>
      <td>55592</td>
      <td>299</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.237663e+18</td>
      <td>338.741038</td>
      <td>-0.402828</td>
      <td>22.13682</td>
      <td>23.77656</td>
      <td>21.61162</td>
      <td>20.50454</td>
      <td>19.25010</td>
      <td>4192</td>
      <td>301</td>
      <td>3</td>
      <td>214</td>
      <td>1.030107e+19</td>
      <td>GALAXY</td>
      <td>0.932346</td>
      <td>9149</td>
      <td>58039</td>
      <td>775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.237680e+18</td>
      <td>345.282593</td>
      <td>21.183866</td>
      <td>19.43718</td>
      <td>17.58028</td>
      <td>16.49747</td>
      <td>15.97711</td>
      <td>15.54461</td>
      <td>8102</td>
      <td>301</td>
      <td>3</td>
      <td>137</td>
      <td>6.891865e+18</td>
      <td>GALAXY</td>
      <td>0.116123</td>
      <td>6121</td>
      <td>56187</td>
      <td>842</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.237680e+18</td>
      <td>340.995121</td>
      <td>20.589476</td>
      <td>23.48827</td>
      <td>23.33776</td>
      <td>21.32195</td>
      <td>20.25615</td>
      <td>19.54544</td>
      <td>8102</td>
      <td>301</td>
      <td>3</td>
      <td>110</td>
      <td>5.658977e+18</td>
      <td>QSO</td>
      <td>1.424659</td>
      <td>5026</td>
      <td>55855</td>
      <td>741</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.237679e+18</td>
      <td>23.234926</td>
      <td>11.418188</td>
      <td>21.46973</td>
      <td>21.17624</td>
      <td>20.92829</td>
      <td>20.60826</td>
      <td>20.42573</td>
      <td>7773</td>
      <td>301</td>
      <td>2</td>
      <td>462</td>
      <td>1.246262e+19</td>
      <td>QSO</td>
      <td>0.586455</td>
      <td>11069</td>
      <td>58456</td>
      <td>113</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.237679e+18</td>
      <td>5.433176</td>
      <td>12.065186</td>
      <td>22.24979</td>
      <td>22.02172</td>
      <td>20.34126</td>
      <td>19.48794</td>
      <td>18.84999</td>
      <td>7773</td>
      <td>301</td>
      <td>2</td>
      <td>346</td>
      <td>6.961443e+18</td>
      <td>GALAXY</td>
      <td>0.477009</td>
      <td>6183</td>
      <td>56210</td>
      <td>15</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.237661e+18</td>
      <td>200.290475</td>
      <td>47.199402</td>
      <td>24.40286</td>
      <td>22.35669</td>
      <td>20.61032</td>
      <td>19.46490</td>
      <td>18.95852</td>
      <td>3716</td>
      <td>301</td>
      <td>5</td>
      <td>108</td>
      <td>7.459285e+18</td>
      <td>GALAXY</td>
      <td>0.660012</td>
      <td>6625</td>
      <td>56386</td>
      <td>719</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.237671e+18</td>
      <td>39.149691</td>
      <td>28.102842</td>
      <td>21.74669</td>
      <td>20.03493</td>
      <td>19.17553</td>
      <td>18.81823</td>
      <td>18.65422</td>
      <td>5934</td>
      <td>301</td>
      <td>4</td>
      <td>122</td>
      <td>2.751763e+18</td>
      <td>STAR</td>
      <td>-0.000008</td>
      <td>2444</td>
      <td>54082</td>
      <td>232</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" id="6AwLqFxZordx">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming &#39;df&#39; is your original DataFrame</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the size of the subsample (adjust the value as needed)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>subsample_size <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># 50% of the original dataset</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subsample of your DataFrame</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sample(frac<span class="op">=</span>subsample_size, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Use &#39;subsample_df&#39; for subsequent steps like model training, hyperparameter tuning, etc.</span></span></code></pre></div>
</div>
<section id="22" class="cell markdown" id="8kHs-2hYp8Xi">
<h3>2.2</h3>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2W_2zacmcslv" data-outputId="bc3f9c79-1100-482d-e3c1-6b2bfd47dfe7">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Basic information about the data:&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.info())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Basic information about the data:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 20000 entries, 75721 to 42410
Data columns (total 18 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   obj_ID       20000 non-null  float64
 1   alpha        20000 non-null  float64
 2   delta        20000 non-null  float64
 3   u            20000 non-null  float64
 4   g            20000 non-null  float64
 5   r            20000 non-null  float64
 6   i            20000 non-null  float64
 7   z            20000 non-null  float64
 8   run_ID       20000 non-null  int64  
 9   rerun_ID     20000 non-null  int64  
 10  cam_col      20000 non-null  int64  
 11  field_ID     20000 non-null  int64  
 12  spec_obj_ID  20000 non-null  float64
 13  class        20000 non-null  object 
 14  redshift     20000 non-null  float64
 15  plate        20000 non-null  int64  
 16  MJD          20000 non-null  int64  
 17  fiber_ID     20000 non-null  int64  
dtypes: float64(10), int64(7), object(1)
memory usage: 2.9+ MB
None
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bgIr7-jAcunC" data-outputId="1ca0a4d2-09fa-4802-8f72-986c3f74fe44">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Size of the dataset:&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Size of the dataset:
(20000, 18)
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ceT6Uc3BcwCm" data-outputId="0ed83f06-18b2-480f-8124-891f696a6ef4">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Basic statistics:&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Basic statistics:
             obj_ID         alpha         delta             u             g  \
count  2.000000e+04  20000.000000  20000.000000  20000.000000  20000.000000   
mean   1.237665e+18    177.828704     24.146161     22.065885     20.626228   
std    8.493015e+12     96.874144     19.623348      2.245218      2.036681   
min    1.237646e+18      0.013337    -17.451390     10.996230     10.511390   
25%    1.237659e+18    127.029010      5.012040     20.336965     18.972295   
50%    1.237663e+18    181.365434     23.742855     22.173205     21.092440   
75%    1.237668e+18    234.136922     39.882597     23.661895     22.117705   
max    1.237681e+18    359.999810     82.947622     29.234380     29.862580   

                  r             i             z        run_ID  rerun_ID  \
count  20000.000000  20000.000000  20000.000000  20000.000000   20000.0   
mean      19.639106     19.084067     18.765492   4495.323450     301.0   
std        1.851280      1.758997      1.763986   1977.442609       0.0   
min       10.068540     11.263940     10.225510    109.000000     301.0   
25%       18.138813     17.730465     17.468595   3187.000000     301.0   
50%       20.116740     19.402810     19.005495   4188.000000     301.0   
75%       21.035343     20.377025     19.913317   5360.000000     301.0   
max       27.397090     30.154600     23.969360   8162.000000     301.0   

            cam_col      field_ID   spec_obj_ID      redshift         plate  \
count  20000.000000  20000.000000  2.000000e+04  20000.000000  20000.000000   
mean       3.512500    188.000400  5.787034e+18      0.574429   5139.808450   
std        1.578439    151.288394  3.308998e+18      0.727153   2938.964549   
min        1.000000     11.000000  2.995191e+17     -0.004255    266.000000   
25%        2.000000     82.000000  2.873341e+18      0.052095   2552.000000   
50%        4.000000    147.000000  5.629664e+18      0.420849   5000.000000   
75%        5.000000    243.000000  8.335174e+18      0.702351   7403.000000   
max        6.000000    982.000000  1.412681e+19      7.011245  12547.000000   

                MJD     fiber_ID  
count  20000.000000  20000.00000  
mean   55594.471900    451.01395  
std     1805.875065    273.17669  
min    51608.000000      1.00000  
25%    54243.000000    221.00000  
50%    55888.000000    435.00000  
75%    56776.250000    647.00000  
max    58932.000000   1000.00000  
</code></pre>
</div>
</div>
<section id="23" class="cell markdown" id="Dmdil4jOqBGU">
<h3>2.3</h3>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="0Ymdu-hNcxnC" data-outputId="f1e03b79-c258-423c-a2f7-0a72bda64afe">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Missing values:&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Missing values:
obj_ID         0
alpha          0
delta          0
u              0
g              0
r              0
i              0
z              0
run_ID         0
rerun_ID       0
cam_col        0
field_ID       0
spec_obj_ID    0
class          0
redshift       0
plate          0
MJD            0
fiber_ID       0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ieRVGS_Acyur" data-outputId="c1ca7159-b441-4937-e131-9c6710e822a0">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df.fillna(df.mean(), inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/var/folders/w6/wff1s8k12sj6xnprmhdvzcbr0000gn/T/ipykernel_7549/2693109243.py:2: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying &#39;numeric_only=None&#39; is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
  df.fillna(df.mean(), inplace=True)
</code></pre>
</div>
</div>
<section id="24" class="cell markdown" id="cSFuNiFGqPHc">
<h3>2.4</h3>
</section>
<div class="cell code" id="Au-6LPX2fy37">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;MJD&#39;</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">&#39;MJD&#39;</span>], unit<span class="op">=</span><span class="st">&#39;D&#39;</span>, origin<span class="op">=</span><span class="st">&#39;1858-11-17&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" id="xMuyCFYxeVRL">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;magnitude&#39;</span>] <span class="op">=</span> df[[<span class="st">&#39;u&#39;</span>, <span class="st">&#39;g&#39;</span>, <span class="st">&#39;r&#39;</span>, <span class="st">&#39;i&#39;</span>, <span class="st">&#39;z&#39;</span>]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="EKOd8S08ghJx">
<p>MJD stands for Modified Julian Date. It's a timekeeping system that
represents the number of days that have passed since November 17, 1858,
at 00:00 UTC (Coordinated Universal Time), but using Julian days (where
each day starts at noon).</p>
<p>In astronomy and astrophysics, magnitude often refers to the measure
of brightness of celestial objects. The 'u', 'g', 'r', 'i', and 'z'
columns in your dataset could potentially represent the brightness of
stars in different wavelength bands or filters.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:313}"
id="8c_fdkojgE-c" data-outputId="94711583-544d-4a2b-b0d6-77d3c0a24f1a">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>obj_ID</th>
      <th>alpha</th>
      <th>delta</th>
      <th>u</th>
      <th>g</th>
      <th>r</th>
      <th>i</th>
      <th>z</th>
      <th>run_ID</th>
      <th>rerun_ID</th>
      <th>cam_col</th>
      <th>field_ID</th>
      <th>spec_obj_ID</th>
      <th>class</th>
      <th>redshift</th>
      <th>plate</th>
      <th>MJD</th>
      <th>fiber_ID</th>
      <th>magnitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>75721</th>
      <td>1.237679e+18</td>
      <td>16.956890</td>
      <td>3.646130</td>
      <td>23.33542</td>
      <td>21.95143</td>
      <td>20.48149</td>
      <td>19.60300</td>
      <td>19.13094</td>
      <td>7712</td>
      <td>301</td>
      <td>6</td>
      <td>442</td>
      <td>4.855017e+18</td>
      <td>GALAXY</td>
      <td>0.506237</td>
      <td>4312</td>
      <td>2010-11-11</td>
      <td>495</td>
      <td>104.50228</td>
    </tr>
    <tr>
      <th>80184</th>
      <td>1.237662e+18</td>
      <td>240.063240</td>
      <td>6.134131</td>
      <td>17.86033</td>
      <td>16.79228</td>
      <td>16.43001</td>
      <td>16.30923</td>
      <td>16.25873</td>
      <td>3894</td>
      <td>301</td>
      <td>1</td>
      <td>243</td>
      <td>2.448928e+18</td>
      <td>STAR</td>
      <td>0.000345</td>
      <td>2175</td>
      <td>2008-05-26</td>
      <td>348</td>
      <td>83.65058</td>
    </tr>
    <tr>
      <th>19864</th>
      <td>1.237679e+18</td>
      <td>30.887222</td>
      <td>1.188710</td>
      <td>18.18911</td>
      <td>16.89469</td>
      <td>16.42161</td>
      <td>16.24627</td>
      <td>16.18549</td>
      <td>7717</td>
      <td>301</td>
      <td>1</td>
      <td>536</td>
      <td>8.255357e+18</td>
      <td>STAR</td>
      <td>0.000004</td>
      <td>7332</td>
      <td>2014-01-26</td>
      <td>943</td>
      <td>83.93717</td>
    </tr>
    <tr>
      <th>76699</th>
      <td>1.237668e+18</td>
      <td>247.594401</td>
      <td>10.887780</td>
      <td>24.99961</td>
      <td>21.71203</td>
      <td>21.47148</td>
      <td>21.30532</td>
      <td>21.29109</td>
      <td>5323</td>
      <td>301</td>
      <td>1</td>
      <td>134</td>
      <td>4.577999e+18</td>
      <td>STAR</td>
      <td>-0.000291</td>
      <td>4066</td>
      <td>2010-09-05</td>
      <td>326</td>
      <td>110.77953</td>
    </tr>
    <tr>
      <th>92991</th>
      <td>1.237679e+18</td>
      <td>18.896451</td>
      <td>-5.261330</td>
      <td>23.76648</td>
      <td>21.79737</td>
      <td>20.69543</td>
      <td>20.23403</td>
      <td>19.97464</td>
      <td>7881</td>
      <td>301</td>
      <td>3</td>
      <td>148</td>
      <td>8.910472e+18</td>
      <td>STAR</td>
      <td>-0.000136</td>
      <td>7914</td>
      <td>2015-11-05</td>
      <td>363</td>
      <td>106.46795</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="31" class="cell markdown" id="nKtDvhYkgF3M">
<h3>3.1</h3>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ggoS1PUghlWW" data-outputId="39d70f15-3486-4fdb-c01d-cb5a66fd159f">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>statistics <span class="op">=</span> numeric_columns.describe()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(statistics)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>             obj_ID         alpha         delta             u             g  \
count  2.000000e+04  20000.000000  20000.000000  20000.000000  20000.000000   
mean   1.237665e+18    177.828704     24.146161     22.065885     20.626228   
std    8.493015e+12     96.874144     19.623348      2.245218      2.036681   
min    1.237646e+18      0.013337    -17.451390     10.996230     10.511390   
25%    1.237659e+18    127.029010      5.012040     20.336965     18.972295   
50%    1.237663e+18    181.365434     23.742855     22.173205     21.092440   
75%    1.237668e+18    234.136922     39.882597     23.661895     22.117705   
max    1.237681e+18    359.999810     82.947622     29.234380     29.862580   

                  r             i             z        run_ID  rerun_ID  \
count  20000.000000  20000.000000  20000.000000  20000.000000   20000.0   
mean      19.639106     19.084067     18.765492   4495.323450     301.0   
std        1.851280      1.758997      1.763986   1977.442609       0.0   
min       10.068540     11.263940     10.225510    109.000000     301.0   
25%       18.138813     17.730465     17.468595   3187.000000     301.0   
50%       20.116740     19.402810     19.005495   4188.000000     301.0   
75%       21.035343     20.377025     19.913317   5360.000000     301.0   
max       27.397090     30.154600     23.969360   8162.000000     301.0   

            cam_col      field_ID   spec_obj_ID      redshift         plate  \
count  20000.000000  20000.000000  2.000000e+04  20000.000000  20000.000000   
mean       3.512500    188.000400  5.787034e+18      0.574429   5139.808450   
std        1.578439    151.288394  3.308998e+18      0.727153   2938.964549   
min        1.000000     11.000000  2.995191e+17     -0.004255    266.000000   
25%        2.000000     82.000000  2.873341e+18      0.052095   2552.000000   
50%        4.000000    147.000000  5.629664e+18      0.420849   5000.000000   
75%        5.000000    243.000000  8.335174e+18      0.702351   7403.000000   
max        6.000000    982.000000  1.412681e+19      7.011245  12547.000000   

          fiber_ID     magnitude  
count  20000.00000  20000.000000  
mean     451.01395    100.180779  
std      273.17669      8.883758  
min        1.00000     56.485700  
25%      221.00000     93.105555  
50%      435.00000    102.782550  
75%      647.00000    107.008615  
max     1000.00000    120.042710  
</code></pre>
</div>
</div>
<section id="32" class="cell markdown" id="rNOsz173hnH9">
<h3>3.2</h3>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="Gt_BFOSrhqUv" data-outputId="6e875d16-0290-4b92-f721-91d6ba7d7607">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> numeric_columns.columns:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    plt.hist(df[column], bins<span class="op">=</span><span class="dv">20</span>)  <span class="co"># Adjust bins as needed</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Distribution of </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(column)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/27bb6008fb9a2c32bca2b663fb2fd3e7b0feb250.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/64b8d3fd79024ff993724cdb2d7f88fe37f7e9b0.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/74b8181702a4c41c310e63244d78011b4ab87413.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/e724c76b53e3b9df2cc7842d7676e32061ed2dc1.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/6f555efd43e1c6bf4e3df9b2acc0e8488390e4f5.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/3c40571def0fbfd260eef245379333a21961d8b8.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/de421b672eb9aab9432501896909fa1a98ace186.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/5e7a78ef583b2c0340078d85b4fc079514b7d84e.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/0f1cb13f23564c8224bbd30866ca177c264c0e1f.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/c1a0f3f1d244a90b0e6c132f7a0b991b63bba314.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/b4298503728dd77857a4331ac9832a43b9a8db63.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/e011b9642dca14a96d2b4a1729e0e887690f7f55.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/0bc821e09eda8229cf07b16fbcf8a637a01f2312.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/60a3dea5db1108ad05585c4145aa6460c278facc.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/6532e960e33e8c4029593e5f8010d23a9e526ab6.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/f55c55b68d0630f9c272422c22291170ef0cad74.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/d791cfb969e98a0287c8059fd704dc3ddb7d4090.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:767}"
id="OwgYmSWUjeim" data-outputId="3f2b6f60-e668-4618-ebe0-2fa05c5bee24">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> df[numeric_columns.columns].corr()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(correlation_matrix, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, mask<span class="op">=</span>mask, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Heatmap&#39;</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/59097106eed5fb6b682b05c1fc49380d532ca353.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="waAgvsjJir6E" data-outputId="fb7e8970-2e8c-4436-8b48-1e4bf7a94118">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;class&#39;</span>, y<span class="op">=</span><span class="st">&#39;magnitude&#39;</span>, data<span class="op">=</span>df)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Boxplot of Numeric Column across Categories&#39;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_82304dacba9d4e96a434cdfbe77b0856/f51267d50ef6110d993c86a23d48edcfda3fa39c.png" /></p>
</div>
</div>
<div class="cell code" id="YZ8j2PNCiwOd">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="EG6KkPUYgVwY">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="a7Sf2XYNgVzy">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="_bWOT_2QgV2T">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code></pre></div>
</div>
<div class="cell code" id="VE5fn-cNi4LT">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(<span class="st">&#39;MJD&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" id="D4es5h9-gcoz">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">&#39;class&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;class&#39;</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div class="cell code" id="oXbK9AU6ioVj">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:75}"
id="4lnI5yQYgYTt" data-outputId="c7ed306a-b011-4802-fe13-c557f139fe73">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dt_model <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>dt_model.fit(X_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">
<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(random_state=42)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JP1Tt93GidIQ" data-outputId="a1d552d6-e3ba-4964-bdd4-7ff39262b8ad">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>y_pred_dt <span class="op">=</span> dt_model.predict(X_test)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Decision Tree Classifier Performance:&quot;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_dt))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy_score(y_test, y_pred_dt))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Decision Tree Classifier Performance:
              precision    recall  f1-score   support

      GALAXY       0.97      0.97      0.97      2344
         QSO       0.90      0.92      0.91       785
        STAR       1.00      1.00      1.00       871

    accuracy                           0.96      4000
   macro avg       0.96      0.96      0.96      4000
weighted avg       0.96      0.96      0.96      4000

Accuracy: 0.963
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="NlpS0nZFjA8v" data-outputId="022f6207-355c-43af-ef41-854b590186f4">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>param_grid_dt <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="va">None</span>], <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>]}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>grid_search_dt <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>dt_model, param_grid<span class="op">=</span>param_grid_dt, cv<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>grid_search_dt.fit(X_train, y_train)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, grid_search_dt.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;max_depth&#39;: 10, &#39;min_samples_split&#39;: 5}
</code></pre>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="EsnMSuSvjCWM" data-outputId="7df458bb-8925-460b-ba74-a8a665bb120d">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>best_dt_model <span class="op">=</span> grid_search_dt.best_estimator_</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>y_pred_tuned_dt <span class="op">=</span> best_dt_model.predict(X_test)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned Decision Tree Classifier Performance:&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_tuned_dt))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy (Tuned Model):&quot;</span>, accuracy_score(y_test, y_pred_tuned_dt))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tuned Decision Tree Classifier Performance:
              precision    recall  f1-score   support

      GALAXY       0.97      0.98      0.98      2344
         QSO       0.95      0.91      0.93       785
        STAR       1.00      1.00      1.00       871

    accuracy                           0.97      4000
   macro avg       0.97      0.96      0.97      4000
weighted avg       0.97      0.97      0.97      4000

Accuracy (Tuned Model): 0.97175
</code></pre>
</div>
</div>
<div class="cell code" id="ribg3y2bjUgB">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="1Hc7L-Avkeny">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:75}"
id="-ZvYL9tNkh1h" data-outputId="873d4a03-af8b-4863-8c0d-660c89c4e910">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>rf_model.fit(X_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier(random_state=42)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="fi0ka8PLkjTn" data-outputId="29caa7f9-455a-421d-fb95-39ead0ef5e13">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf_model.predict(X_test)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Classifier Performance:&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_rf))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy:&quot;</span>, accuracy_score(y_test, y_pred_rf))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Random Forest Classifier Performance:
              precision    recall  f1-score   support

      GALAXY       0.98      0.98      0.98      2344
         QSO       0.97      0.93      0.95       785
        STAR       0.98      1.00      0.99       871

    accuracy                           0.98      4000
   macro avg       0.97      0.97      0.97      4000
weighted avg       0.98      0.98      0.98      4000

Accuracy: 0.97525
</code></pre>
</div>
</div>
<div class="cell code" id="hFaz6KRareRV">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" id="gBehiP9bklRs"
data-outputId="f26c67d5-3fbe-4e35-c684-45c2541d3291">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>param_grid_rf <span class="op">=</span> {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>],</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="va">None</span>],</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_features&#39;</span>: [<span class="st">&#39;sqrt&#39;</span>, <span class="st">&#39;log2&#39;</span>]</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>grid_search_rf <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>rf_model, param_grid<span class="op">=</span>param_grid_rf, cv<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>grid_search_rf.fit(X_train, y_train)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Parameters:&quot;</span>, grid_search_rf.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Parameters: {&#39;max_depth&#39;: 15, &#39;max_features&#39;: &#39;sqrt&#39;, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 300}
</code></pre>
</div>
</div>
<div class="cell code" id="g2H9-laNkmxX"
data-outputId="42ec4ca1-05ff-4e96-9dc7-e60d17184b73">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>best_rf_model <span class="op">=</span> grid_search_rf.best_estimator_</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>y_pred_tuned_rf <span class="op">=</span> best_rf_model.predict(X_test)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned Random Forest Classifier Performance:&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_tuned_rf))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Accuracy (Tuned Model):&quot;</span>, accuracy_score(y_test, y_pred_tuned_rf))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tuned Random Forest Classifier Performance:
              precision    recall  f1-score   support

      GALAXY       0.98      0.98      0.98      2344
         QSO       0.96      0.93      0.95       785
        STAR       0.98      1.00      0.99       871

    accuracy                           0.98      4000
   macro avg       0.97      0.97      0.97      4000
weighted avg       0.98      0.98      0.98      4000

Accuracy (Tuned Model): 0.97525
</code></pre>
</div>
</div>
<div class="cell code" id="jSvCigBJknPe">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
